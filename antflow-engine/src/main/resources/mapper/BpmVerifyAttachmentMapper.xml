<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.openoa.engine.bpmnconf.mapper.BpmVerifyAttachmentMapper">


    <resultMap id="BaseResultMap" type="org.openoa.base.entity.BpmVerifyAttachment">
        <id column="id" property="id"/>
        <result column="verify_info_id" property="verifyInfoId"/>
        <result column="file_path" property="filePath"/>
        <result column="new_file_name" property="newFileName"/>
        <result column="original_file_name" property="originalFileName"/>
        <result column="file_size" property="fileSize"/>
        <result column="file_type" property="fileType"/>
        <result column="file_url" property="fileUrl"/>
        <result column="create_time" property="createTime"/>
    </resultMap>

    <sql id="baseSql">
        id,
        verify_info_id as verifyInfoId,
        file_path as filePath,
        new_file_name as newFileName,
        original_file_name as originalFileName,
        file_size as fileSize,
        file_url as fileUrl,
        file_type as fileType,
        is_del as isDel,
    </sql>
    <select id="getVerifyAttachment"  parameterType="org.openoa.base.vo.BpmVerifyAttachmentVo"  resultMap="BaseResultMap">
        <include refid="baseSql"/>
        <where>
            <if test="id != null "> and id = #{id}</if>
            <if test="verifyInfoId != null "> and verify_info_id = #{verifyInfoId}</if>
            <if test="newFileName != null  and newFileName != ''"> and new_file_name like concat('%', #{newFileName}, '%')</if>
            <if test="originalFileName != null  and originalFileName != ''"> and original_file_name like concat('%', #{originalFileName}, '%')</if>
            <if test="fileType != null "> and file_type = #{fileType}</if>
        </where>
        order by create_time desc
    </select>

    <select id="getVerifyAttachmentList"  parameterType="long" resultType="org.openoa.base.vo.BpmVerifyAttachmentVo">
        select id,
        verify_info_id as verifyInfoId,
        file_path as filePath,
        new_file_name as newFileName,
        original_file_name as originalFileName,
        file_size as fileSize,
        file_url as fileUrl,
        file_type as fileType,
        is_del as isDel,
        create_time as createTime
        from bpm_verify_attachment
        <where>
            <if test="verifyInfoId != null and verifyInfoId != 0 "> and verify_info_id = #{verifyInfoId}</if>
        </where>
        order by create_time desc
    </select>
</mapper>
